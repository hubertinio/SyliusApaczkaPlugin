<?xml version="1.0" encoding="UTF-8" ?>

<container xmlns="http://symfony.com/schema/dic/services" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">
    <services>
        <defaults                 autowire="true"  autoconfigure="true"/>

<!--        <service id="Hubertinio\SyliusApaczkaPlugin\Controller\GreetingController" autowire="true" autoconfigure="true" public="true" />-->

        <!-- @TODO https://symfony.com/doc/current/bundles/configuration.html -->
        <service id="hubertinio.apaczka.api.client"
                 class="Hubertinio\SyliusApaczkaPlugin\Api\ApaczkaApiClient">
                    <argument key="$appId">1352150_2c039ebd279355ec_63VFbdW</argument>
                    <argument key="$appSecret">5kbtajsttpzukslktbogasggjbqwi1c1</argument>
        </service>

        <service id="hubertinio.apaczka.api.cached_client"
                 class="Hubertinio\SyliusApaczkaPlugin\Api\CachedApaczkaApiClient">
            <argument type="service" id="hubertinio.apaczka.api.client" />
            <argument type="service" id="cache.app" />
        </service>

        <service id="Hubertinio\SyliusApaczkaPlugin\Api\ApaczkaApiClientInterface" alias="hubertinio.apaczka.api.cached_client"/>

        <service id="hubertinio.apaczka.cli.ping"
                 class="Hubertinio\SyliusApaczkaPlugin\Cli\PingCommand">
            <argument type="service" id="hubertinio.apaczka.api.client" />
            <tag name="console.command"/>
        </service>

        <service id="hubertinio.apaczka.cli.dev"
                 class="Hubertinio\SyliusApaczkaPlugin\Cli\DevCommand">
            <argument type="service" id="hubertinio.apaczka.api.cached_client" />
            <tag name="console.command"/>
        </service>

        <service id="hubertinio.apaczka.cli.load_points"
                 class="Hubertinio\SyliusApaczkaPlugin\Cli\LoadPointsCommand">
            <argument type="service" id="hubertinio.apaczka.api.cached_client" />
            <tag name="console.command"/>
        </service>

        <service id="hubertinio.apaczka.cli.load_services"
                 class="Hubertinio\SyliusApaczkaPlugin\Cli\LoadServicesCommand">
            <argument type="service" id="hubertinio.apaczka.api.cached_client" />
            <tag name="console.command"/>
        </service>

        <!-- @TODO shipping charges calculator -->
        <!-- @TODO \Sylius\Bundle\ShippingBundle\DependencyInjection\Compiler\RegisterShippingMethodsResolversPass -->
        <service id="hubertinio.apaczka.address_shipping_calculator"
                 class="Hubertinio\SyliusApaczkaPlugin\Calculator\PerApaczkaOrderRateCalculator">
            <tag name="hubertinio.apaczka.shipping_calculator"
                 calculator="per_apaczka_order_rate"
                 form-type="Sylius\Bundle\CoreBundle\Form\Type\Shipping\Calculator\ChannelBasedPerUnitRateConfigurationType"
                 label="sylius.form.shipping_calculator.per_unit_rate_configuration.label"/>
        </service>
    </services>
</container>
